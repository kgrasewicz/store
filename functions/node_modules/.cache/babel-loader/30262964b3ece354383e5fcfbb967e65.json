{"ast":null,"code":"import _taggedTemplateLiteralLoose from \"@babel/runtime/helpers/esm/taggedTemplateLiteralLoose\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteralLoose([\"none\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport React, { useRef, useState, useCallback, useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport pick from 'lodash/pick';\nimport isUndefined from 'lodash/isUndefined';\nimport isNil from 'lodash/isNil';\nimport isFunction from 'lodash/isFunction';\nimport omit from 'lodash/omit';\nimport { createChainedFunction, getDataGroupBy, useCustom, useClassNames, useControlled, mergeRefs, shallowEqual } from '../utils';\nimport { DropdownMenu, DropdownMenuItem, PickerToggle, PickerToggleTrigger, PickerOverlay, SearchBar, useFocusItemValue, usePickerClassName, useSearch, usePublicMethods, useToggleKeyDownEvent, pickTriggerPropKeys, omitTriggerPropKeys, listPickerPropTypes } from '../Picker';\nvar defaultProps = {\n  as: 'div',\n  appearance: 'default',\n  classPrefix: 'picker',\n  searchable: true,\n  cleanable: true,\n  data: [],\n  disabledItemValues: [],\n  valueKey: 'value',\n  labelKey: 'label',\n  placement: 'bottomStart',\n  menuAutoWidth: true,\n  menuMaxHeight: 320\n};\nvar SelectPicker = /*#__PURE__*/React.forwardRef(function (props, ref) {\n  var Component = props.as,\n      data = props.data,\n      valueKey = props.valueKey,\n      labelKey = props.labelKey,\n      valueProp = props.value,\n      classPrefix = props.classPrefix,\n      placeholder = props.placeholder,\n      defaultValue = props.defaultValue,\n      disabled = props.disabled,\n      cleanable = props.cleanable,\n      placement = props.placement,\n      menuClassName = props.menuClassName,\n      menuAutoWidth = props.menuAutoWidth,\n      menuMaxHeight = props.menuMaxHeight,\n      menuStyle = props.menuStyle,\n      groupBy = props.groupBy,\n      overrideLocale = props.locale,\n      toggleAs = props.toggleAs,\n      style = props.style,\n      searchable = props.searchable,\n      disabledItemValues = props.disabledItemValues,\n      virtualized = props.virtualized,\n      listProps = props.listProps,\n      id = props.id,\n      onGroupTitleClick = props.onGroupTitleClick,\n      searchBy = props.searchBy,\n      onEntered = props.onEntered,\n      onExited = props.onExited,\n      onClean = props.onClean,\n      onChange = props.onChange,\n      onSelect = props.onSelect,\n      onSearch = props.onSearch,\n      onClose = props.onClose,\n      onOpen = props.onOpen,\n      sort = props.sort,\n      renderValue = props.renderValue,\n      renderMenu = props.renderMenu,\n      renderMenuGroup = props.renderMenuGroup,\n      renderMenuItem = props.renderMenuItem,\n      renderExtraFooter = props.renderExtraFooter,\n      rest = _objectWithoutPropertiesLoose(props, [\"as\", \"data\", \"valueKey\", \"labelKey\", \"value\", \"classPrefix\", \"placeholder\", \"defaultValue\", \"disabled\", \"cleanable\", \"placement\", \"menuClassName\", \"menuAutoWidth\", \"menuMaxHeight\", \"menuStyle\", \"groupBy\", \"locale\", \"toggleAs\", \"style\", \"searchable\", \"disabledItemValues\", \"virtualized\", \"listProps\", \"id\", \"onGroupTitleClick\", \"searchBy\", \"onEntered\", \"onExited\", \"onClean\", \"onChange\", \"onSelect\", \"onSearch\", \"onClose\", \"onOpen\", \"sort\", \"renderValue\", \"renderMenu\", \"renderMenuGroup\", \"renderMenuItem\", \"renderExtraFooter\"]);\n\n  var triggerRef = useRef();\n  var targetRef = useRef();\n  var overlayRef = useRef();\n\n  var _useCustom = useCustom('Picker', overrideLocale),\n      locale = _useCustom.locale;\n\n  var _useControlled = useControlled(valueProp, defaultValue),\n      value = _useControlled[0],\n      setValue = _useControlled[1]; // Used to hover the focus item  when trigger `onKeydown`\n\n\n  var _useFocusItemValue = useFocusItemValue(value, {\n    data: data,\n    valueKey: valueKey,\n    target: function target() {\n      return overlayRef.current;\n    }\n  }),\n      focusItemValue = _useFocusItemValue.focusItemValue,\n      setFocusItemValue = _useFocusItemValue.setFocusItemValue,\n      onFocusItem = _useFocusItemValue.onKeyDown; // Use search keywords to filter options.\n\n\n  var _useSearch = useSearch({\n    labelKey: labelKey,\n    data: data,\n    searchBy: searchBy,\n    callback: function callback(searchKeyword, filteredData, event) {\n      var _filteredData$; // The first option after filtering is the focus.\n\n\n      setFocusItemValue(filteredData === null || filteredData === void 0 ? void 0 : (_filteredData$ = filteredData[0]) === null || _filteredData$ === void 0 ? void 0 : _filteredData$[valueKey]);\n      onSearch === null || onSearch === void 0 ? void 0 : onSearch(searchKeyword, event);\n    }\n  }),\n      searchKeyword = _useSearch.searchKeyword,\n      filteredData = _useSearch.filteredData,\n      updateFilteredData = _useSearch.updateFilteredData,\n      setSearchKeyword = _useSearch.setSearchKeyword,\n      handleSearch = _useSearch.handleSearch;\n\n  useEffect(function () {\n    updateFilteredData(data);\n  }, [data, updateFilteredData]); // Use component active state to support keyboard events.\n\n  var _useState = useState(false),\n      active = _useState[0],\n      setActive = _useState[1];\n\n  var handleClose = useCallback(function () {\n    var _triggerRef$current, _triggerRef$current$c;\n\n    (_triggerRef$current = triggerRef.current) === null || _triggerRef$current === void 0 ? void 0 : (_triggerRef$current$c = _triggerRef$current.close) === null || _triggerRef$current$c === void 0 ? void 0 : _triggerRef$current$c.call(_triggerRef$current);\n  }, []);\n  var handleSelect = useCallback(function (value, item, event) {\n    var _targetRef$current;\n\n    onSelect === null || onSelect === void 0 ? void 0 : onSelect(value, item, event);\n    (_targetRef$current = targetRef.current) === null || _targetRef$current === void 0 ? void 0 : _targetRef$current.focus();\n  }, [onSelect]);\n  var handleChangeValue = useCallback(function (value, event) {\n    onChange === null || onChange === void 0 ? void 0 : onChange(value, event);\n  }, [onChange]);\n  var handleMenuPressEnter = useCallback(function (event) {\n    if (!focusItemValue) {\n      return;\n    } // Find active `MenuItem` by `value`\n\n\n    var focusItem = data.find(function (item) {\n      return shallowEqual(item[valueKey], focusItemValue);\n    });\n    setValue(focusItemValue);\n    handleSelect(focusItemValue, focusItem, event);\n    handleChangeValue(focusItemValue, event);\n    handleClose();\n  }, [data, focusItemValue, handleChangeValue, handleClose, handleSelect, setValue, valueKey]);\n  var handleItemSelect = useCallback(function (value, item, event) {\n    setValue(value);\n    setFocusItemValue(value);\n    handleSelect(value, item, event);\n    handleChangeValue(value, event);\n    handleClose();\n  }, [setValue, setFocusItemValue, handleSelect, handleChangeValue, handleClose]);\n  var handleClean = useCallback(function (event) {\n    if (disabled || !cleanable) {\n      return;\n    }\n\n    setValue(null);\n    setFocusItemValue(value);\n    handleChangeValue(null, event);\n  }, [value, disabled, cleanable, setValue, handleChangeValue, setFocusItemValue]);\n  var onPickerKeyDown = useToggleKeyDownEvent(_extends({\n    toggle: !focusItemValue || !active,\n    triggerRef: triggerRef,\n    targetRef: targetRef,\n    overlayRef: overlayRef,\n    active: active,\n    onExit: handleClean,\n    onMenuKeyDown: onFocusItem,\n    onMenuPressEnter: handleMenuPressEnter,\n    onClose: function onClose() {\n      setFocusItemValue(null);\n    }\n  }, rest));\n  var handleExited = useCallback(function () {\n    setSearchKeyword('');\n    setActive(false);\n    onClose === null || onClose === void 0 ? void 0 : onClose();\n  }, [onClose, setSearchKeyword]);\n  var handleEntered = useCallback(function () {\n    setActive(true);\n    setFocusItemValue(value);\n    onOpen === null || onOpen === void 0 ? void 0 : onOpen();\n  }, [onOpen, setFocusItemValue, value]);\n  usePublicMethods(ref, {\n    triggerRef: triggerRef,\n    overlayRef: overlayRef,\n    targetRef: targetRef\n  }); // Find active `MenuItem` by `value`\n\n  var activeItem = data.find(function (item) {\n    return shallowEqual(item[valueKey], value);\n  });\n  /**\n   * 1.Have a value and the value is valid.\n   * 2.Regardless of whether the value is valid, as long as renderValue is set, it is judged to have a value.\n   */\n\n  var hasValue = !!activeItem || !isNil(value) && isFunction(renderValue);\n\n  var _useClassNames = useClassNames(classPrefix),\n      prefix = _useClassNames.prefix,\n      merge = _useClassNames.merge;\n\n  var selectedElement = placeholder;\n\n  if (activeItem === null || activeItem === void 0 ? void 0 : activeItem[labelKey]) {\n    selectedElement = activeItem[labelKey];\n  }\n\n  if (!isNil(value) && isFunction(renderValue)) {\n    selectedElement = renderValue(value, activeItem, selectedElement); // If renderValue returns null or undefined, hasValue is false.\n\n    if (isNil(selectedElement)) {\n      hasValue = false;\n    }\n  }\n\n  var renderDropdownMenu = function renderDropdownMenu(positionProps, speakerRef) {\n    var left = positionProps.left,\n        top = positionProps.top,\n        className = positionProps.className;\n    var classes = merge(className, menuClassName, prefix('select-menu'));\n\n    var styles = _extends({}, menuStyle, {\n      left: left,\n      top: top\n    });\n\n    var items = filteredData; // Create a tree structure data when set `groupBy`\n\n    if (groupBy) {\n      items = getDataGroupBy(items, groupBy, sort);\n    } else if (typeof sort === 'function') {\n      items = items.sort(sort(false));\n    }\n\n    var menu = items.length ? /*#__PURE__*/React.createElement(DropdownMenu, {\n      id: id ? id + \"-listbox\" : undefined,\n      listProps: listProps,\n      disabledItemValues: disabledItemValues,\n      valueKey: valueKey,\n      labelKey: labelKey,\n      renderMenuGroup: renderMenuGroup,\n      renderMenuItem: renderMenuItem,\n      maxHeight: menuMaxHeight,\n      classPrefix: 'picker-select-menu',\n      dropdownMenuItemClassPrefix: 'picker-select-menu-item',\n      dropdownMenuItemAs: DropdownMenuItem,\n      activeItemValues: [value],\n      focusItemValue: focusItemValue,\n      data: items,\n      group: !isUndefined(groupBy),\n      onSelect: handleItemSelect,\n      onGroupTitleClick: onGroupTitleClick,\n      virtualized: virtualized\n    }) : /*#__PURE__*/React.createElement(\"div\", {\n      className: prefix(_templateObject())\n    }, locale === null || locale === void 0 ? void 0 : locale.noResultsText);\n    return /*#__PURE__*/React.createElement(PickerOverlay, {\n      ref: mergeRefs(overlayRef, speakerRef),\n      autoWidth: menuAutoWidth,\n      className: classes,\n      style: styles,\n      onKeyDown: onPickerKeyDown,\n      target: triggerRef\n    }, searchable && /*#__PURE__*/React.createElement(SearchBar, {\n      placeholder: locale === null || locale === void 0 ? void 0 : locale.searchPlaceholder,\n      onChange: handleSearch,\n      value: searchKeyword\n    }), renderMenu ? renderMenu(menu) : menu, renderExtraFooter === null || renderExtraFooter === void 0 ? void 0 : renderExtraFooter());\n  };\n\n  var _usePickerClassName = usePickerClassName(_extends({}, props, {\n    hasValue: hasValue,\n    name: 'select'\n  })),\n      classes = _usePickerClassName[0],\n      usedClassNamePropKeys = _usePickerClassName[1];\n\n  return /*#__PURE__*/React.createElement(PickerToggleTrigger, {\n    pickerProps: pick(props, pickTriggerPropKeys),\n    ref: triggerRef,\n    placement: placement,\n    onEntered: createChainedFunction(handleEntered, onEntered),\n    onExited: createChainedFunction(handleExited, onExited),\n    speaker: renderDropdownMenu\n  }, /*#__PURE__*/React.createElement(Component, {\n    className: classes,\n    style: style\n  }, /*#__PURE__*/React.createElement(PickerToggle, _extends({}, omit(rest, [].concat(omitTriggerPropKeys, usedClassNamePropKeys)), {\n    id: id,\n    ref: targetRef,\n    onClean: createChainedFunction(handleClean, onClean),\n    onKeyDown: onPickerKeyDown,\n    as: toggleAs,\n    disabled: disabled,\n    cleanable: cleanable && !disabled,\n    hasValue: hasValue,\n    inputValue: value,\n    active: active,\n    placement: placement\n  }), selectedElement || (locale === null || locale === void 0 ? void 0 : locale.placeholder))));\n});\nSelectPicker.displayName = 'SelectPicker';\nSelectPicker.defaultProps = defaultProps;\nSelectPicker.propTypes = _extends({}, listPickerPropTypes, {\n  locale: PropTypes.any,\n  appearance: PropTypes.oneOf(['default', 'subtle']),\n  menuAutoWidth: PropTypes.bool,\n  menuMaxHeight: PropTypes.number,\n  renderMenu: PropTypes.func,\n  renderMenuItem: PropTypes.func,\n  renderMenuGroup: PropTypes.func,\n  onSelect: PropTypes.func,\n  onGroupTitleClick: PropTypes.func,\n  onSearch: PropTypes.func,\n\n  /**\n   * group by key in `data`\n   */\n  groupBy: PropTypes.any,\n  sort: PropTypes.func,\n  searchable: PropTypes.bool,\n  virtualized: PropTypes.bool,\n  searchBy: PropTypes.func\n});\nexport default SelectPicker;","map":{"version":3,"sources":["C:/Programowanie/store/node_modules/rsuite/es/SelectPicker/SelectPicker.js"],"names":["_taggedTemplateLiteralLoose","_extends","_objectWithoutPropertiesLoose","_templateObject","data","React","useRef","useState","useCallback","useEffect","PropTypes","pick","isUndefined","isNil","isFunction","omit","createChainedFunction","getDataGroupBy","useCustom","useClassNames","useControlled","mergeRefs","shallowEqual","DropdownMenu","DropdownMenuItem","PickerToggle","PickerToggleTrigger","PickerOverlay","SearchBar","useFocusItemValue","usePickerClassName","useSearch","usePublicMethods","useToggleKeyDownEvent","pickTriggerPropKeys","omitTriggerPropKeys","listPickerPropTypes","defaultProps","as","appearance","classPrefix","searchable","cleanable","disabledItemValues","valueKey","labelKey","placement","menuAutoWidth","menuMaxHeight","SelectPicker","forwardRef","props","ref","Component","valueProp","value","placeholder","defaultValue","disabled","menuClassName","menuStyle","groupBy","overrideLocale","locale","toggleAs","style","virtualized","listProps","id","onGroupTitleClick","searchBy","onEntered","onExited","onClean","onChange","onSelect","onSearch","onClose","onOpen","sort","renderValue","renderMenu","renderMenuGroup","renderMenuItem","renderExtraFooter","rest","triggerRef","targetRef","overlayRef","_useCustom","_useControlled","setValue","_useFocusItemValue","target","current","focusItemValue","setFocusItemValue","onFocusItem","onKeyDown","_useSearch","callback","searchKeyword","filteredData","event","_filteredData$","updateFilteredData","setSearchKeyword","handleSearch","_useState","active","setActive","handleClose","_triggerRef$current","_triggerRef$current$c","close","call","handleSelect","item","_targetRef$current","focus","handleChangeValue","handleMenuPressEnter","focusItem","find","handleItemSelect","handleClean","onPickerKeyDown","toggle","onExit","onMenuKeyDown","onMenuPressEnter","handleExited","handleEntered","activeItem","hasValue","_useClassNames","prefix","merge","selectedElement","renderDropdownMenu","positionProps","speakerRef","left","top","className","classes","styles","items","menu","length","createElement","undefined","maxHeight","dropdownMenuItemClassPrefix","dropdownMenuItemAs","activeItemValues","group","noResultsText","autoWidth","searchPlaceholder","_usePickerClassName","name","usedClassNamePropKeys","pickerProps","speaker","concat","inputValue","displayName","propTypes","any","oneOf","bool","number","func"],"mappings":"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","sourcesContent":["import _taggedTemplateLiteralLoose from \"@babel/runtime/helpers/esm/taggedTemplateLiteralLoose\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteralLoose([\"none\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport React, { useRef, useState, useCallback, useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport pick from 'lodash/pick';\nimport isUndefined from 'lodash/isUndefined';\nimport isNil from 'lodash/isNil';\nimport isFunction from 'lodash/isFunction';\nimport omit from 'lodash/omit';\nimport { createChainedFunction, getDataGroupBy, useCustom, useClassNames, useControlled, mergeRefs, shallowEqual } from '../utils';\nimport { DropdownMenu, DropdownMenuItem, PickerToggle, PickerToggleTrigger, PickerOverlay, SearchBar, useFocusItemValue, usePickerClassName, useSearch, usePublicMethods, useToggleKeyDownEvent, pickTriggerPropKeys, omitTriggerPropKeys, listPickerPropTypes } from '../Picker';\nvar defaultProps = {\n  as: 'div',\n  appearance: 'default',\n  classPrefix: 'picker',\n  searchable: true,\n  cleanable: true,\n  data: [],\n  disabledItemValues: [],\n  valueKey: 'value',\n  labelKey: 'label',\n  placement: 'bottomStart',\n  menuAutoWidth: true,\n  menuMaxHeight: 320\n};\nvar SelectPicker = /*#__PURE__*/React.forwardRef(function (props, ref) {\n  var Component = props.as,\n      data = props.data,\n      valueKey = props.valueKey,\n      labelKey = props.labelKey,\n      valueProp = props.value,\n      classPrefix = props.classPrefix,\n      placeholder = props.placeholder,\n      defaultValue = props.defaultValue,\n      disabled = props.disabled,\n      cleanable = props.cleanable,\n      placement = props.placement,\n      menuClassName = props.menuClassName,\n      menuAutoWidth = props.menuAutoWidth,\n      menuMaxHeight = props.menuMaxHeight,\n      menuStyle = props.menuStyle,\n      groupBy = props.groupBy,\n      overrideLocale = props.locale,\n      toggleAs = props.toggleAs,\n      style = props.style,\n      searchable = props.searchable,\n      disabledItemValues = props.disabledItemValues,\n      virtualized = props.virtualized,\n      listProps = props.listProps,\n      id = props.id,\n      onGroupTitleClick = props.onGroupTitleClick,\n      searchBy = props.searchBy,\n      onEntered = props.onEntered,\n      onExited = props.onExited,\n      onClean = props.onClean,\n      onChange = props.onChange,\n      onSelect = props.onSelect,\n      onSearch = props.onSearch,\n      onClose = props.onClose,\n      onOpen = props.onOpen,\n      sort = props.sort,\n      renderValue = props.renderValue,\n      renderMenu = props.renderMenu,\n      renderMenuGroup = props.renderMenuGroup,\n      renderMenuItem = props.renderMenuItem,\n      renderExtraFooter = props.renderExtraFooter,\n      rest = _objectWithoutPropertiesLoose(props, [\"as\", \"data\", \"valueKey\", \"labelKey\", \"value\", \"classPrefix\", \"placeholder\", \"defaultValue\", \"disabled\", \"cleanable\", \"placement\", \"menuClassName\", \"menuAutoWidth\", \"menuMaxHeight\", \"menuStyle\", \"groupBy\", \"locale\", \"toggleAs\", \"style\", \"searchable\", \"disabledItemValues\", \"virtualized\", \"listProps\", \"id\", \"onGroupTitleClick\", \"searchBy\", \"onEntered\", \"onExited\", \"onClean\", \"onChange\", \"onSelect\", \"onSearch\", \"onClose\", \"onOpen\", \"sort\", \"renderValue\", \"renderMenu\", \"renderMenuGroup\", \"renderMenuItem\", \"renderExtraFooter\"]);\n\n  var triggerRef = useRef();\n  var targetRef = useRef();\n  var overlayRef = useRef();\n\n  var _useCustom = useCustom('Picker', overrideLocale),\n      locale = _useCustom.locale;\n\n  var _useControlled = useControlled(valueProp, defaultValue),\n      value = _useControlled[0],\n      setValue = _useControlled[1]; // Used to hover the focus item  when trigger `onKeydown`\n\n\n  var _useFocusItemValue = useFocusItemValue(value, {\n    data: data,\n    valueKey: valueKey,\n    target: function target() {\n      return overlayRef.current;\n    }\n  }),\n      focusItemValue = _useFocusItemValue.focusItemValue,\n      setFocusItemValue = _useFocusItemValue.setFocusItemValue,\n      onFocusItem = _useFocusItemValue.onKeyDown; // Use search keywords to filter options.\n\n\n  var _useSearch = useSearch({\n    labelKey: labelKey,\n    data: data,\n    searchBy: searchBy,\n    callback: function callback(searchKeyword, filteredData, event) {\n      var _filteredData$;\n\n      // The first option after filtering is the focus.\n      setFocusItemValue(filteredData === null || filteredData === void 0 ? void 0 : (_filteredData$ = filteredData[0]) === null || _filteredData$ === void 0 ? void 0 : _filteredData$[valueKey]);\n      onSearch === null || onSearch === void 0 ? void 0 : onSearch(searchKeyword, event);\n    }\n  }),\n      searchKeyword = _useSearch.searchKeyword,\n      filteredData = _useSearch.filteredData,\n      updateFilteredData = _useSearch.updateFilteredData,\n      setSearchKeyword = _useSearch.setSearchKeyword,\n      handleSearch = _useSearch.handleSearch;\n\n  useEffect(function () {\n    updateFilteredData(data);\n  }, [data, updateFilteredData]); // Use component active state to support keyboard events.\n\n  var _useState = useState(false),\n      active = _useState[0],\n      setActive = _useState[1];\n\n  var handleClose = useCallback(function () {\n    var _triggerRef$current, _triggerRef$current$c;\n\n    (_triggerRef$current = triggerRef.current) === null || _triggerRef$current === void 0 ? void 0 : (_triggerRef$current$c = _triggerRef$current.close) === null || _triggerRef$current$c === void 0 ? void 0 : _triggerRef$current$c.call(_triggerRef$current);\n  }, []);\n  var handleSelect = useCallback(function (value, item, event) {\n    var _targetRef$current;\n\n    onSelect === null || onSelect === void 0 ? void 0 : onSelect(value, item, event);\n    (_targetRef$current = targetRef.current) === null || _targetRef$current === void 0 ? void 0 : _targetRef$current.focus();\n  }, [onSelect]);\n  var handleChangeValue = useCallback(function (value, event) {\n    onChange === null || onChange === void 0 ? void 0 : onChange(value, event);\n  }, [onChange]);\n  var handleMenuPressEnter = useCallback(function (event) {\n    if (!focusItemValue) {\n      return;\n    } // Find active `MenuItem` by `value`\n\n\n    var focusItem = data.find(function (item) {\n      return shallowEqual(item[valueKey], focusItemValue);\n    });\n    setValue(focusItemValue);\n    handleSelect(focusItemValue, focusItem, event);\n    handleChangeValue(focusItemValue, event);\n    handleClose();\n  }, [data, focusItemValue, handleChangeValue, handleClose, handleSelect, setValue, valueKey]);\n  var handleItemSelect = useCallback(function (value, item, event) {\n    setValue(value);\n    setFocusItemValue(value);\n    handleSelect(value, item, event);\n    handleChangeValue(value, event);\n    handleClose();\n  }, [setValue, setFocusItemValue, handleSelect, handleChangeValue, handleClose]);\n  var handleClean = useCallback(function (event) {\n    if (disabled || !cleanable) {\n      return;\n    }\n\n    setValue(null);\n    setFocusItemValue(value);\n    handleChangeValue(null, event);\n  }, [value, disabled, cleanable, setValue, handleChangeValue, setFocusItemValue]);\n  var onPickerKeyDown = useToggleKeyDownEvent(_extends({\n    toggle: !focusItemValue || !active,\n    triggerRef: triggerRef,\n    targetRef: targetRef,\n    overlayRef: overlayRef,\n    active: active,\n    onExit: handleClean,\n    onMenuKeyDown: onFocusItem,\n    onMenuPressEnter: handleMenuPressEnter,\n    onClose: function onClose() {\n      setFocusItemValue(null);\n    }\n  }, rest));\n  var handleExited = useCallback(function () {\n    setSearchKeyword('');\n    setActive(false);\n    onClose === null || onClose === void 0 ? void 0 : onClose();\n  }, [onClose, setSearchKeyword]);\n  var handleEntered = useCallback(function () {\n    setActive(true);\n    setFocusItemValue(value);\n    onOpen === null || onOpen === void 0 ? void 0 : onOpen();\n  }, [onOpen, setFocusItemValue, value]);\n  usePublicMethods(ref, {\n    triggerRef: triggerRef,\n    overlayRef: overlayRef,\n    targetRef: targetRef\n  }); // Find active `MenuItem` by `value`\n\n  var activeItem = data.find(function (item) {\n    return shallowEqual(item[valueKey], value);\n  });\n  /**\n   * 1.Have a value and the value is valid.\n   * 2.Regardless of whether the value is valid, as long as renderValue is set, it is judged to have a value.\n   */\n\n  var hasValue = !!activeItem || !isNil(value) && isFunction(renderValue);\n\n  var _useClassNames = useClassNames(classPrefix),\n      prefix = _useClassNames.prefix,\n      merge = _useClassNames.merge;\n\n  var selectedElement = placeholder;\n\n  if (activeItem === null || activeItem === void 0 ? void 0 : activeItem[labelKey]) {\n    selectedElement = activeItem[labelKey];\n  }\n\n  if (!isNil(value) && isFunction(renderValue)) {\n    selectedElement = renderValue(value, activeItem, selectedElement); // If renderValue returns null or undefined, hasValue is false.\n\n    if (isNil(selectedElement)) {\n      hasValue = false;\n    }\n  }\n\n  var renderDropdownMenu = function renderDropdownMenu(positionProps, speakerRef) {\n    var left = positionProps.left,\n        top = positionProps.top,\n        className = positionProps.className;\n    var classes = merge(className, menuClassName, prefix('select-menu'));\n\n    var styles = _extends({}, menuStyle, {\n      left: left,\n      top: top\n    });\n\n    var items = filteredData; // Create a tree structure data when set `groupBy`\n\n    if (groupBy) {\n      items = getDataGroupBy(items, groupBy, sort);\n    } else if (typeof sort === 'function') {\n      items = items.sort(sort(false));\n    }\n\n    var menu = items.length ? /*#__PURE__*/React.createElement(DropdownMenu, {\n      id: id ? id + \"-listbox\" : undefined,\n      listProps: listProps,\n      disabledItemValues: disabledItemValues,\n      valueKey: valueKey,\n      labelKey: labelKey,\n      renderMenuGroup: renderMenuGroup,\n      renderMenuItem: renderMenuItem,\n      maxHeight: menuMaxHeight,\n      classPrefix: 'picker-select-menu',\n      dropdownMenuItemClassPrefix: 'picker-select-menu-item',\n      dropdownMenuItemAs: DropdownMenuItem,\n      activeItemValues: [value],\n      focusItemValue: focusItemValue,\n      data: items,\n      group: !isUndefined(groupBy),\n      onSelect: handleItemSelect,\n      onGroupTitleClick: onGroupTitleClick,\n      virtualized: virtualized\n    }) : /*#__PURE__*/React.createElement(\"div\", {\n      className: prefix(_templateObject())\n    }, locale === null || locale === void 0 ? void 0 : locale.noResultsText);\n    return /*#__PURE__*/React.createElement(PickerOverlay, {\n      ref: mergeRefs(overlayRef, speakerRef),\n      autoWidth: menuAutoWidth,\n      className: classes,\n      style: styles,\n      onKeyDown: onPickerKeyDown,\n      target: triggerRef\n    }, searchable && /*#__PURE__*/React.createElement(SearchBar, {\n      placeholder: locale === null || locale === void 0 ? void 0 : locale.searchPlaceholder,\n      onChange: handleSearch,\n      value: searchKeyword\n    }), renderMenu ? renderMenu(menu) : menu, renderExtraFooter === null || renderExtraFooter === void 0 ? void 0 : renderExtraFooter());\n  };\n\n  var _usePickerClassName = usePickerClassName(_extends({}, props, {\n    hasValue: hasValue,\n    name: 'select'\n  })),\n      classes = _usePickerClassName[0],\n      usedClassNamePropKeys = _usePickerClassName[1];\n\n  return /*#__PURE__*/React.createElement(PickerToggleTrigger, {\n    pickerProps: pick(props, pickTriggerPropKeys),\n    ref: triggerRef,\n    placement: placement,\n    onEntered: createChainedFunction(handleEntered, onEntered),\n    onExited: createChainedFunction(handleExited, onExited),\n    speaker: renderDropdownMenu\n  }, /*#__PURE__*/React.createElement(Component, {\n    className: classes,\n    style: style\n  }, /*#__PURE__*/React.createElement(PickerToggle, _extends({}, omit(rest, [].concat(omitTriggerPropKeys, usedClassNamePropKeys)), {\n    id: id,\n    ref: targetRef,\n    onClean: createChainedFunction(handleClean, onClean),\n    onKeyDown: onPickerKeyDown,\n    as: toggleAs,\n    disabled: disabled,\n    cleanable: cleanable && !disabled,\n    hasValue: hasValue,\n    inputValue: value,\n    active: active,\n    placement: placement\n  }), selectedElement || (locale === null || locale === void 0 ? void 0 : locale.placeholder))));\n});\nSelectPicker.displayName = 'SelectPicker';\nSelectPicker.defaultProps = defaultProps;\nSelectPicker.propTypes = _extends({}, listPickerPropTypes, {\n  locale: PropTypes.any,\n  appearance: PropTypes.oneOf(['default', 'subtle']),\n  menuAutoWidth: PropTypes.bool,\n  menuMaxHeight: PropTypes.number,\n  renderMenu: PropTypes.func,\n  renderMenuItem: PropTypes.func,\n  renderMenuGroup: PropTypes.func,\n  onSelect: PropTypes.func,\n  onGroupTitleClick: PropTypes.func,\n  onSearch: PropTypes.func,\n\n  /**\n   * group by key in `data`\n   */\n  groupBy: PropTypes.any,\n  sort: PropTypes.func,\n  searchable: PropTypes.bool,\n  virtualized: PropTypes.bool,\n  searchBy: PropTypes.func\n});\nexport default SelectPicker;"]},"metadata":{},"sourceType":"module"}