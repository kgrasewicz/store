{"ast":null,"code":"import _classCallCheck from\"C:/Programowanie/store/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"C:/Programowanie/store/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"C:/Programowanie/store/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"C:/Programowanie/store/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import axios from\"axios\";import FetchProductImg from\"./FetchProductImg\";import{withRouter,NavLink}from\"react-router-dom\";import $ from\"jquery\";import Aux from\"react-aux\";import PopUp from\"./Popup\";import InputForm from\"./InputForm\";import _ from\"lodash\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ProductItem=/*#__PURE__*/function(_Component){_inherits(ProductItem,_Component);var _super=_createSuper(ProductItem);function ProductItem(props){var _this;_classCallCheck(this,ProductItem);_this=_super.call(this,props);_this._isMounted=false;_this.componentDidMount=function(){_this._isMounted=true;var id=_this.props.match.params.id;_this.fetchItem(id);};_this.componentDidUpdate=function(prevProps,prevState){if(prevProps.match.params.id!==_this.props.match.params.id){_this._isMounted=true;_this.fetchItem(_this.props.match.params.id);}};_this.fetchItem=function(id){axios.get(\"/api/products/\"+id).then(function(response){if(_this._isMounted){console.log(response);_this.setState({product:response.data});_this.setState({stock:_this.state.product.stock});}}).catch(function(error){console.log(error);});};_this.SizePickerHandler=function(){$(\".product-item-container__info__size-picker__arrow\").toggleClass(\"active\");$(\".product-item-container__info__size-picker__list\").toggleClass(\"active\");};_this.handleCartClick=function(event){if($(event.target).is(\".pop-cart-continue#pop__svg\")){$(\".pop-cart-continue\").toggleClass(\"active\");}};_this.addToCart=function(){axios.post(\"/api/cart\",{productId:_this.state.product._id,productName:_this.state.product.product_name,model:_this.state.product.product_id,category:_this.state.product.category,size:_this.state.stock.length===1?\"One size\":sessionStorage.getItem(\"chosenSize\"),price:_this.state.product.price_new,quantity:1}).then(function(response){console.log(response);axios.get(\"/api/cart\").then(function(response){$(\".items-counter\").text(response.data.itemsTotal);console.log(response);}).catch(function(error){console.log(error);});},function(error){console.log(error);});};_this.cartHandler=function(event){if(_this.state.stock.length!==1&&$(\".product-item-container__info__size-picker__default\").text()!=\"Select\"||_this.state.stock.length===1){console.log(!sessionStorage.getItem(\"chosenSize\"));var chosenSize=sessionStorage.getItem(\"chosenSize\")===\"One Size\"||!sessionStorage.getItem(\"chosenSize\")?1:sessionStorage.getItem(\"chosenSize\");console.log(chosenSize);console.log(_this.state.product.stock.findIndex(function(x){return x.size==chosenSize;}));var index=_this.state.product.stock.findIndex(function(x){return x.size==chosenSize;});if(_this.state.product.stock[index].quantity>0){_this.addToCart();}sessionStorage.setItem(\"chosenSize\",\"One Size\");$(\".pop-cart-continue\").toggleClass(\"active\");}};_this.state={product:[],stock:[]};_this.props=props;return _this;}_createClass(ProductItem,[{key:\"componentWillUnmount\",value:function componentWillUnmount(){this._isMounted=false;}},{key:\"handleNotifyClick\",value:function handleNotifyClick(event){if($(event.target).is(\"h2.notify\")||$(event.target).is(\".notify#pop__svg\")){$(\".notify\").toggleClass(\"active\");$(\".product-item-container__info__size-picker__arrow\").toggleClass(\"active\");$(\".product-item-container__info__size-picker__list\").toggleClass(\"active\");}if($(event.target).hasClass(\"value\")){$(\".product-item-container__info__size-picker__default\").text($(event.target).text());sessionStorage.setItem(\"chosenSize\",$(\".product-item-container__info__size-picker__default\").text());$(\".product-item-container__info__size-picker__arrow\").toggleClass(\"active\");$(\".product-item-container__info__size-picker__list\").toggleClass(\"active\");}}},{key:\"postNotify\",value:function postNotify(event){$(\".pop__content__button__svg__tick\").toggleClass(\"active\");$(\".pop__content__button__svg__arrow\").toggleClass(\"active\");setTimeout(function(){$(\".notify\").toggleClass(\"active\");$(\".pop__content__button__svg__arrow\").toggleClass(\"active\");$(\".pop__content__button__svg__tick\").toggleClass(\"active\");},2000);}},{key:\"render\",value:function render(){var _this2=this;var stock=this.state.stock.map(function(stockItem){if(stockItem.quantity===\"0\"){return/*#__PURE__*/_jsxs(\"li\",{className:\"unavailable \"+(stockItem.size===\"1\"?\"out-of-stock\":\"\"),children:[/*#__PURE__*/_jsx(\"h2\",{children:stockItem.size===\"1\"?\"One size\":stockItem.size}),/*#__PURE__*/_jsx(\"h2\",{className:\"notify\",children:\"Notify me when available\"})]},stockItem.size.toString());}else{return/*#__PURE__*/_jsx(\"li\",{className:\"available\",children:/*#__PURE__*/_jsx(\"h2\",{className:\"value\",children:stockItem.size})},stockItem.size.toString());}});var SizePicker=function SizePicker(){if(stock.length>1){return/*#__PURE__*/_jsxs(\"div\",{className:\"product-item-container__info__size-picker\",children:[/*#__PURE__*/_jsxs(\"h2\",{onClick:_this2.SizePickerHandler,className:\"product-item-container__info__size-picker__title\",children:[\"Size:\",\" \"]}),/*#__PURE__*/_jsx(\"h2\",{onClick:_this2.SizePickerHandler,className:\"product-item-container__info__size-picker__default\",children:\"Select\"}),/*#__PURE__*/_jsx(\"div\",{onClick:_this2.SizePickerHandler,className:\"product-item-container__info__size-picker__arrow\"}),/*#__PURE__*/_jsx(\"ul\",{onClick:_this2.handleNotifyClick,className:\"product-item-container__info__size-picker__list\",children:stock})]});}else{return/*#__PURE__*/_jsx(\"div\",{className:\"product-item-container__info__size-picker single\",onClick:_this2.handleNotifyClick,children:stock});}};return/*#__PURE__*/_jsxs(Aux,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"product-item-container\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"product-item-container__back\",onClick:this.props.history.goBack,children:/*#__PURE__*/_jsxs(\"h2\",{children:[\"\\uD83E\\uDC60 \\xA0 back to \",this.state.product.category]})}),/*#__PURE__*/_jsx(FetchProductImg,{className:this.state.product.product_id,link:this.state.product.product_id}),/*#__PURE__*/_jsxs(\"div\",{className:\"product-item-container__info\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"product-item-container__info__main\",children:[/*#__PURE__*/_jsx(\"h4\",{children:this.state.product.product_name}),/*#__PURE__*/_jsxs(\"div\",{className:\"product-item-container__info__main__price-container\",children:[/*#__PURE__*/_jsxs(\"h4\",{className:this.state.product.discount_val>0?\"product-item-container__info__main__price-container__old-price\":\"product-item-container__info__main__price-container__price\",children:[this.state.product.price,\" PLN\"]}),/*#__PURE__*/_jsx(\"h4\",{className:\"product-item-container__info__main__price-container__new-price\",children:this.state.product.discount_val>0?this.state.product.price_new+\" PLN\":\"\"})]}),/*#__PURE__*/_jsxs(\"h3\",{children:[\"Model: \",this.state.product.product_id]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"product-item-container__info__desc\",children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"Specifications: \",this.state.product.specs]}),/*#__PURE__*/_jsxs(\"h2\",{children:[\"Material: \",this.state.product.material]}),/*#__PURE__*/_jsxs(\"h2\",{children:[\"Collection: \",this.state.product.collection_name]})]}),SizePicker(),/*#__PURE__*/_jsx(\"button\",{onClick:this.cartHandler,className:\"product-item-container__info__button\",children:\"Add to cart\"})]})]},this.state.product._id),/*#__PURE__*/_jsxs(PopUp,{popClass:\"pop-cart-continue\",handler:this.handleCartClick,children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Item has been sucessfuly added to cart.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"pop-cart-continue__buttons\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"pop-cart-continue__buttons__continue\",onClick:function onClick(){return $('.pop-cart-continue').toggleClass(\"active\");},children:\"Continue shopping\"}),/*#__PURE__*/_jsx(NavLink,{to:\"/shop/cart\",children:/*#__PURE__*/_jsx(\"button\",{className:\"pop-cart-continue__buttons__cart\",children:\"Go to cart\"})})]})]}),/*#__PURE__*/_jsxs(PopUp,{popClass:\"notify\",handler:this.handleNotifyClick,children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Enter your e-mail address and we we will notify you when the item is available.\"}),/*#__PURE__*/_jsx(InputForm,{handler:this.postNotify,class:\"pop__content__button pop\",type:\"text\",name:\"email\",placeholder:\"Enter your email\",children:/*#__PURE__*/_jsxs(\"svg\",{version:\"1.1\",id:\"pop__content__button__svg\",xmlns:\"http://www.w3.org/2000/svg\",x:\"0px\",y:\"0px\",width:\"408px\",height:\"408px\",viewBox:\"0 0 408 408\",enableBackground:\"new 0 0 408 408;\",children:[/*#__PURE__*/_jsx(\"path\",{className:\"pop__content__button__svg__arrow active\",d:\"M0,229.5h311.1L168.3,372.3L204,408l204-204L204,0l-35.7,35.7l142.8,142.8H0L0,229.5z\"}),/*#__PURE__*/_jsx(\"path\",{className:\"pop__content__button__svg__tick\",d:\"M9.5,224.5l133.2,133.5l255.8-255.5l-36.7-36.2L142.7,285l-97-97L9.5,224.5z\"})]})})]})]});}}]);return ProductItem;}(Component);export default withRouter(ProductItem);","map":{"version":3,"sources":["C:/Programowanie/store/src/Components/Shop/ProductItem.js"],"names":["React","Component","axios","FetchProductImg","withRouter","NavLink","$","Aux","PopUp","InputForm","_","ProductItem","props","_isMounted","componentDidMount","id","match","params","fetchItem","componentDidUpdate","prevProps","prevState","get","then","response","console","log","setState","product","data","stock","state","catch","error","SizePickerHandler","toggleClass","handleCartClick","event","target","is","addToCart","post","productId","_id","productName","product_name","model","product_id","category","size","length","sessionStorage","getItem","price","price_new","quantity","text","itemsTotal","cartHandler","chosenSize","findIndex","x","index","setItem","hasClass","setTimeout","map","stockItem","toString","SizePicker","handleNotifyClick","history","goBack","discount_val","specs","material","collection_name","postNotify"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport axios from \"axios\";\r\nimport FetchProductImg from \"./FetchProductImg\";\r\nimport { withRouter, NavLink } from \"react-router-dom\";\r\nimport $ from \"jquery\";\r\nimport Aux from \"react-aux\";\r\nimport PopUp from \"./Popup\";\r\nimport InputForm from \"./InputForm\";\r\nimport _ from \"lodash\";\r\n\r\nclass ProductItem extends Component {\r\n  _isMounted = false;\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      product: [],\r\n      stock: [],\r\n    };\r\n\r\n    this.props = props;\r\n  }\r\n\r\n  componentDidMount = () => {\r\n    this._isMounted = true;\r\n    const id = this.props.match.params.id;\r\n    this.fetchItem(id);\r\n  };\r\n\r\n  componentDidUpdate = (prevProps, prevState) => {\r\n    if (prevProps.match.params.id !== this.props.match.params.id) {\r\n      this._isMounted = true;\r\n      this.fetchItem(this.props.match.params.id);\r\n    }\r\n  };\r\n\r\n  fetchItem = (id) => {\r\n    axios\r\n      .get(\"/api/products/\" + id)\r\n      .then((response) => {\r\n        if (this._isMounted) {\r\n          console.log(response);\r\n          this.setState({\r\n            product: response.data,\r\n          });\r\n          this.setState({\r\n            stock: this.state.product.stock,\r\n          });\r\n        }\r\n      })\r\n      .catch((error) => {\r\n        console.log(error);\r\n      });\r\n  };\r\n\r\n  SizePickerHandler = () => {\r\n    $(\".product-item-container__info__size-picker__arrow\").toggleClass(\r\n      \"active\"\r\n    );\r\n    $(\".product-item-container__info__size-picker__list\").toggleClass(\"active\");\r\n  };\r\n\r\n  componentWillUnmount() {\r\n    this._isMounted = false;\r\n  }\r\n\r\n  handleNotifyClick(event) {\r\n    if (\r\n      $(event.target).is(\"h2.notify\") ||\r\n      $(event.target).is(\".notify#pop__svg\")\r\n    ) {\r\n      $(\".notify\").toggleClass(\"active\");\r\n      $(\".product-item-container__info__size-picker__arrow\").toggleClass(\r\n        \"active\"\r\n      );\r\n      $(\".product-item-container__info__size-picker__list\").toggleClass(\r\n        \"active\"\r\n      );\r\n    }\r\n\r\n    if ($(event.target).hasClass(\"value\")) {\r\n      $(\".product-item-container__info__size-picker__default\").text(\r\n        $(event.target).text()\r\n      );\r\n\r\n      sessionStorage.setItem(\r\n        \"chosenSize\",\r\n        $(\".product-item-container__info__size-picker__default\").text()\r\n      );\r\n\r\n      $(\".product-item-container__info__size-picker__arrow\").toggleClass(\r\n        \"active\"\r\n      );\r\n      $(\".product-item-container__info__size-picker__list\").toggleClass(\r\n        \"active\"\r\n      );\r\n    }\r\n  }\r\n\r\n  handleCartClick = (event) => {\r\n    if ($(event.target).is(\".pop-cart-continue#pop__svg\")) {\r\n      $(\".pop-cart-continue\").toggleClass(\"active\");\r\n    }\r\n  };\r\n\r\n  addToCart = () => {\r\n    \r\n      axios\r\n      .post(\"/api/cart\", {\r\n        productId: this.state.product._id,\r\n        productName: this.state.product.product_name,\r\n        model: this.state.product.product_id,\r\n        category: this.state.product.category,\r\n        size:\r\n          this.state.stock.length === 1\r\n            ? \"One size\"\r\n            : sessionStorage.getItem(\"chosenSize\"),\r\n        price: this.state.product.price_new,\r\n        quantity: 1,\r\n      })\r\n      .then(\r\n        (response) => {\r\n          console.log(response);\r\n\r\n          axios\r\n            .get(\"/api/cart\")\r\n            .then((response) => {\r\n              $(\".items-counter\").text(response.data.itemsTotal);\r\n\r\n              console.log(response);\r\n            })\r\n            .catch((error) => {\r\n              console.log(error);\r\n            });\r\n        },\r\n        (error) => {\r\n          console.log(error);\r\n        }\r\n      );\r\n    \r\n    \r\n  };\r\n\r\n  cartHandler = (event) => {\r\n\r\n    if ((this.state.stock.length !== 1 && $(\".product-item-container__info__size-picker__default\").text() != \"Select\") || this.state.stock.length === 1) {\r\n      console.log(!sessionStorage.getItem(\"chosenSize\"))\r\n      let chosenSize = (sessionStorage.getItem(\"chosenSize\") === \"One Size\" || !sessionStorage.getItem(\"chosenSize\")) ? 1 : sessionStorage.getItem(\"chosenSize\");\r\n      console.log(chosenSize)\r\n      console.log(this.state.product.stock.findIndex(\r\n        (x) => x.size == chosenSize))\r\n      let index = this.state.product.stock.findIndex(\r\n        (x) => x.size == chosenSize)\r\n        \r\n      if (this.state.product.stock[index].quantity > 0) {\r\n        this.addToCart();\r\n      }\r\n      \r\n      sessionStorage.setItem(\r\n        \"chosenSize\",\r\n        \"One Size\"\r\n      );\r\n      $(\".pop-cart-continue\").toggleClass(\"active\");\r\n    }\r\n    \r\n  };\r\n\r\n  postNotify(event) {\r\n    $(\".pop__content__button__svg__tick\").toggleClass(\"active\");\r\n    $(\".pop__content__button__svg__arrow\").toggleClass(\"active\");\r\n\r\n    setTimeout(() => {\r\n      $(\".notify\").toggleClass(\"active\");\r\n      $(\".pop__content__button__svg__arrow\").toggleClass(\"active\");\r\n      $(\".pop__content__button__svg__tick\").toggleClass(\"active\");\r\n    }, 2000);\r\n  }\r\n\r\n  render() {\r\n    const stock = this.state.stock.map(function (stockItem) {\r\n      if (stockItem.quantity === \"0\") {\r\n        return (\r\n          <li key={stockItem.size.toString()} className={\"unavailable \" + ((stockItem.size === \"1\") ? \"out-of-stock\" : \"\")} >\r\n            <h2>{(stockItem.size === \"1\") ? \"One size\" : stockItem.size}</h2>\r\n            <h2 className=\"notify\">Notify me when available</h2>\r\n          </li>\r\n        );\r\n      } else {\r\n        return (\r\n          <li key={stockItem.size.toString()} className=\"available\">\r\n            <h2 className=\"value\">{stockItem.size}</h2>\r\n          </li>\r\n        );\r\n      }\r\n    })\r\n    \r\n    const SizePicker = () => {\r\n      \r\n      if (stock.length > 1) {\r\n        return (\r\n          <div className=\"product-item-container__info__size-picker\">\r\n            <h2\r\n              onClick={this.SizePickerHandler}\r\n              className=\"product-item-container__info__size-picker__title\"\r\n            >\r\n              Size:{\" \"}\r\n            </h2>\r\n            <h2\r\n              onClick={this.SizePickerHandler}\r\n              className=\"product-item-container__info__size-picker__default\"\r\n            >\r\n              Select\r\n            </h2>\r\n            <div\r\n              onClick={this.SizePickerHandler}\r\n              className=\"product-item-container__info__size-picker__arrow\"\r\n            ></div>\r\n            <ul\r\n              onClick={this.handleNotifyClick}\r\n              className=\"product-item-container__info__size-picker__list\"\r\n            >\r\n              {stock}\r\n            </ul>\r\n          </div>\r\n        );\r\n      } else {\r\n          return (\r\n            <div className=\"product-item-container__info__size-picker single\" onClick={this.handleNotifyClick}>{stock}</div>\r\n          )\r\n        }\r\n      \r\n    };\r\n\r\n    return (\r\n      <Aux>\r\n        <div className=\"product-item-container\" key={this.state.product._id}>\r\n          <button\r\n            className=\"product-item-container__back\"\r\n            onClick={this.props.history.goBack}\r\n          >\r\n            <h2>🡠 &nbsp; back to {this.state.product.category}</h2>\r\n          </button>\r\n          <FetchProductImg\r\n            className={this.state.product.product_id}\r\n            link={this.state.product.product_id}\r\n          />\r\n          <div className=\"product-item-container__info\">\r\n            <div className=\"product-item-container__info__main\">\r\n              <h4>{this.state.product.product_name}</h4>\r\n              <div className=\"product-item-container__info__main__price-container\">\r\n              <h4 className={(this.state.product.discount_val > 0) ? \"product-item-container__info__main__price-container__old-price\" : \"product-item-container__info__main__price-container__price\"}>\r\n                {this.state.product.price} PLN\r\n              </h4>\r\n              <h4 className=\"product-item-container__info__main__price-container__new-price\">{this.state.product.discount_val > 0 ? this.state.product.price_new + \" PLN\" : \"\"}</h4>\r\n              </div>\r\n              <h3>Model: {this.state.product.product_id}</h3>\r\n            </div>\r\n            <div className=\"product-item-container__info__desc\">\r\n              <h2>Specifications: {this.state.product.specs}</h2>\r\n              <h2>Material: {this.state.product.material}</h2>\r\n              <h2>Collection: {this.state.product.collection_name}</h2>\r\n            </div>\r\n            {SizePicker()}\r\n            <button\r\n              onClick={this.cartHandler}\r\n              className=\"product-item-container__info__button\"\r\n            >\r\n              Add to cart\r\n            </button>\r\n          </div>\r\n        </div>\r\n        <PopUp popClass=\"pop-cart-continue\" handler={this.handleCartClick}>\r\n          <h2>Item has been sucessfuly added to cart.</h2>\r\n          <div className=\"pop-cart-continue__buttons\">\r\n            <button className=\"pop-cart-continue__buttons__continue\" onClick={() => $('.pop-cart-continue').toggleClass(\"active\")}>\r\n              Continue shopping\r\n            </button>\r\n            <NavLink to=\"/shop/cart\">\r\n              <button className=\"pop-cart-continue__buttons__cart\">\r\n                Go to cart\r\n              </button>\r\n            </NavLink>\r\n          </div>\r\n        </PopUp>\r\n\r\n        <PopUp popClass=\"notify\" handler={this.handleNotifyClick}>\r\n          <h2>\r\n            Enter your e-mail address and we we will notify you when the item is\r\n            available.\r\n          </h2>\r\n          <InputForm\r\n            handler={this.postNotify}\r\n            class=\"pop__content__button pop\"\r\n            type=\"text\"\r\n            name=\"email\"\r\n            placeholder=\"Enter your email\"\r\n          >\r\n            <svg\r\n              version=\"1.1\"\r\n              id=\"pop__content__button__svg\"\r\n              xmlns=\"http://www.w3.org/2000/svg\"\r\n              x=\"0px\"\r\n              y=\"0px\"\r\n              width=\"408px\"\r\n              height=\"408px\"\r\n              viewBox=\"0 0 408 408\"\r\n              enableBackground=\"new 0 0 408 408;\"\r\n            >\r\n              <path\r\n                className=\"pop__content__button__svg__arrow active\"\r\n                d=\"M0,229.5h311.1L168.3,372.3L204,408l204-204L204,0l-35.7,35.7l142.8,142.8H0L0,229.5z\"\r\n              />\r\n              <path\r\n                className=\"pop__content__button__svg__tick\"\r\n                d=\"M9.5,224.5l133.2,133.5l255.8-255.5l-36.7-36.2L142.7,285l-97-97L9.5,224.5z\"\r\n              />\r\n            </svg>\r\n          </InputForm>\r\n        </PopUp>\r\n      </Aux>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withRouter(ProductItem);\r\n"]},"metadata":{},"sourceType":"module"}